<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vector Look-Ups and Safer Sampling • zmisc</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Vector Look-Ups and Safer Sampling">
<meta name="description" content="A collection of utility functions that facilitate looking up vector values from a lookup table, annotate values in at table for clearer viewing, and support a safer approach to vector sampling, sequence generation, and aggregation.">
<meta property="og:description" content="A collection of utility functions that facilitate looking up vector values from a lookup table, annotate values in at table for clearer viewing, and support a safer approach to vector sampling, sequence generation, and aggregation.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">zmisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/zmisc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/torfason/zmisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="zmisc">zmisc<a class="anchor" aria-label="anchor" href="#zmisc"></a>
</h1></div>
<!-- README.md is generated from README.Rmd -->
<!-- badges: start -->

<div class="section level2">
<h2 id="vector-look-ups-and-safer-sampling">Vector Look-Ups and Safer Sampling<a class="anchor" aria-label="anchor" href="#vector-look-ups-and-safer-sampling"></a>
</h2>
<p>A collection of utility functions that facilitate looking up vector values from a lookup table, annotate values in at table for clearer viewing, and support a safer approach to vector sampling, sequence generation, and aggregation.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of <code>zmisc</code> from <a href="https://cran.r-project.org/package=zmisc" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"zmisc"</span><span class="op">)</span></span></code></pre></div>
<p>You can use <code>pak</code> to install the development version of <code>zmisc</code> from <a href="https://github.com/torfason/zmisc" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"torfason/zmisc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>In order to use the package, you generally want to attach it first:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/torfason/zmisc/" class="external-link">zmisc</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-and-easy-value-lookups">Quick and easy value lookups<a class="anchor" aria-label="anchor" href="#quick-and-easy-value-lookups"></a>
</h2>
<p>The functions <a href="https://torfason.github.io/zmisc/reference/lookup.html">lookup()</a> and <a href="https://torfason.github.io/zmisc/reference/lookuper.html">lookuper()</a> are used to look up values from a lookup table, which can be supplied as a <code>vector</code>, a <code>list</code>, or a <code>data.frame</code>. The functions are in some ways similar to the Excel function <code>VLOOKUP()</code>, but are designed to work smoothly in an R workflow, in particular within pipes.</p>
<div class="section level3">
<h3 id="lookup-lookup-values-from-a-lookup-table">lookup: Lookup values from a lookup table<a class="anchor" aria-label="anchor" href="#lookup-lookup-values-from-a-lookup-table"></a>
</h3>
<p>The <a href="https://torfason.github.io/zmisc/reference/lookup.html">lookup()</a> function implements lookup of values (such as variable names) from a lookup table which maps keys onto values (such as variable labels or descriptions).</p>
<p>The lookup table can be in the form of a two-column <code>data.frame</code>, in the form of a named <code>vector</code>, or in the form of a <code>list</code>. If the table is in the form of a <code>data.frame</code>, the key column should be named either <code>key</code> or <code>name</code>, and the value column should be named <code>value</code> (for the value). If the lookup table is in the form of a named <code>vector</code> or <code>list</code>, the names are used as the key, and the returned value is taken from the values in the vector or list.</p>
<p>The underlying lookup is done using <code><a href="https://rdrr.io/r/base/match.html" class="external-link">base::match()</a></code>, and all atomic data types except <code>factor</code> are supported. Factors are omitted due to the ambiguity in what should be looked up (the values or the levels). It is important that <code>x</code>, <code>.default</code> and the columns of <code>lookup_table</code> are all of the same type (specifically of the same <code><a href="https://rdrr.io/r/base/mode.html" class="external-link">base::mode()</a></code>). If the lookup table is specified as a <code>vector</code> or <code>list</code>, only the <code>character</code> variables are supported, because <code>name(lookup_table)</code> is always of mode <code>character</code>.</p>
<p>Original values are returned if they are not found in the lookup table. Alternatively, a <code>.default</code> can be specified for values that are not found. Note that it is possible to specify <code>NA</code> as one of the keys to look up NA values (only when using a <code>data.frame</code> as lookup table).</p>
<p>Any names or attributes of x are preserved.</p>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fruit_lookup_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Apple"</span>, b <span class="op">=</span> <span class="st">"Banana"</span>, c <span class="op">=</span> <span class="st">"Cherry"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/lookup.html">lookup</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">fruit_lookup_vector</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/lookup.html">lookup</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">fruit_lookup_vector</span>, .default <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars_lookup_data_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"hp"</span>, <span class="st">"wt"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Miles/(US) gallon"</span>, <span class="st">"Gross horsepower"</span>, <span class="st">"Weight (1000 lbs)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/lookup.html">lookup</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="va">mtcars_lookup_data_frame</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A more complex example, with numeric and NA values</span></span>
<span><span class="va">numeric_lookup_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="cn">NA</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">99999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/lookup.html">lookup</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">6</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="va">numeric_lookup_table</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="lookuper-construct-lookup-function-based-on-a-specific-lookup-table">lookuper: Construct lookup function based on a specific lookup table<a class="anchor" aria-label="anchor" href="#lookuper-construct-lookup-function-based-on-a-specific-lookup-table"></a>
</h3>
<p>The <a href="https://torfason.github.io/zmisc/reference/lookuper.html">lookuper()</a> function returns <em>a function</em> equivalent to the <a href="https://torfason.github.io/zmisc/reference/lookup.html">lookup()</a> function, except that instead of taking a lookup table as an argument, the lookup table is embedded in the function itself.</p>
<p>This can be very useful, in particular when using the lookup function as an argument to other functions that expect a function which maps <code>character</code>-&gt;<code>character</code> (or other data types), but do not offer a good way to pass additional arguments to that function.</p>
<div class="section level4">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lookup_fruits</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lookup.html">lookuper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Apple"</span>, b <span class="op">=</span> <span class="st">"Banana"</span>, c <span class="op">=</span> <span class="st">"Cherry"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">lookup_fruits</span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">lookup_fruits_nomatch_na</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/lookup.html">lookuper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="st">"Apple"</span>, b <span class="op">=</span> <span class="st">"Banana"</span>, c <span class="op">=</span> <span class="st">"Cherry"</span><span class="op">)</span>, .default <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu">lookup_fruits_nomatch_na</span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="safer-sampling-sequencing-and-aggregation">Safer sampling, sequencing and aggregation<a class="anchor" aria-label="anchor" href="#safer-sampling-sequencing-and-aggregation"></a>
</h2>
<p>The functions <a href="https://torfason.github.io/zmisc/reference/zample.html">zample()</a>, <a href="https://torfason.github.io/zmisc/reference/zeq.html">zeq()</a>, and <a href="https://torfason.github.io/zmisc/reference/zingle.html">zingle()</a> are intended to make your code less likely to break in mysterious ways when you encounter unexpected boundary conditions. The <a href="https://torfason.github.io/zmisc/reference/zample.html">zample()</a> and <a href="https://torfason.github.io/zmisc/reference/zeq.html">zeq()</a> are almost identical to the <a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a> and <a href="https://rdrr.io/r/base/seq.html" class="external-link">seq()</a> functions, but a bit safer.</p>
<div class="section level3">
<h3 id="zample-sample-from-a-vector-in-a-safe-way">zample: Sample from a vector in a safe way<a class="anchor" aria-label="anchor" href="#zample-sample-from-a-vector-in-a-safe-way"></a>
</h3>
<p>The <a href="https://torfason.github.io/zmisc/reference/zample.html">zample()</a> function duplicates the functionality of <a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a>, with the exception that it does not attempt the (sometimes dangerous) user-friendliness of switching the interpretation of the first element to a number if the length of the vector is 1. <code><a href="reference/zample.html">zample()</a></code> <em>always</em> treats its first argument as a vector containing elements that should be sampled, so your code won’t break in unexpected ways when the input vector happens to be of length 1.</p>
<div class="section level4">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For vectors of length 2 or more, zample() and sample() are identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="reference/zample.html">zample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For vectors of length 1, zample() will still sample from the vector,</span></span>
<span><span class="co"># whereas sample() will "magically" switch to interpreting the input</span></span>
<span><span class="co"># as a number n, and sampling from the vector 1:n.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="reference/zample.html">zample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The other arguments work in the same way as for sample()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="reference/zample.html">zample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">11</span>, size<span class="op">=</span><span class="fl">13</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">11</span>, size<span class="op">=</span><span class="fl">13</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Of course, sampling more than the available elements without</span></span>
<span><span class="co"># setting replace=TRUE will result in an error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="reference/zample.html">zample</a></span><span class="op">(</span><span class="fl">7</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, error<span class="op">=</span><span class="va">wrap_error</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="zeq-generate-sequence-in-a-safe-way">zeq: Generate sequence in a safe way<a class="anchor" aria-label="anchor" href="#zeq-generate-sequence-in-a-safe-way"></a>
</h3>
<p>The <a href="https://torfason.github.io/zmisc/reference/zeq.html">zeq()</a> function creates an increasing integer sequence, but differs from the standard one in that it will not silently generate a decreasing sequence when the second argument is smaller than the first. If the second argument is one smaller than the first it will generate an empty sequence, if the difference is greater, the function will throw an error.</p>
<div class="section level4">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For increasing sequences, zeq() and seq() are identical</span></span>
<span><span class="fu"><a href="reference/zeq.html">zeq</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/zeq.html">zeq</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If second argument equals first-1, an empty sequence is returned</span></span>
<span><span class="fu"><a href="reference/zeq.html">zeq</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If second argument is less than first-1, the function throws an error</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="reference/zeq.html">zeq</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">9</span><span class="op">)</span>, error<span class="op">=</span><span class="va">wrap_error</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="zingle-return-the-single-unique-value-found-in-a-vector">zingle: Return the single (unique) value found in a vector<a class="anchor" aria-label="anchor" href="#zingle-return-the-single-unique-value-found-in-a-vector"></a>
</h3>
<p>The <a href="https://torfason.github.io/zmisc/reference/zingle.html">zingle()</a> function returns the first element in a vector, but only if all the other elements are identical to the first one (the vector only has a <code>zingle</code> value). If the elements are not all identical, it throws an error. The vector must contain at least one non-<code>NA</code> value, or the function errors out as well. This is especially useful in aggregations, when all values in a given group should be identical, but you want to make sure.</p>
<div class="section level4">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If all elements are identical, all is good.</span></span>
<span><span class="co"># The value of the element is returned.</span></span>
<span><span class="fu"><a href="reference/zingle.html">zingle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alpha"</span>, <span class="st">"Alpha"</span>, <span class="st">"Alpha"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If any elements differ, an error is thrown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="reference/zingle.html">zingle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alpha"</span>, <span class="st">"Beta"</span>, <span class="st">"Alpha"</span><span class="op">)</span><span class="op">)</span>, error<span class="op">=</span><span class="va">wrap_error</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span>, warn.conflicts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">id</span>, <span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">fouls</span>,</span>
<span>    <span class="fl">1</span>, <span class="st">"James"</span>, <span class="fl">3</span>,</span>
<span>    <span class="fl">2</span>, <span class="st">"Jack"</span>,  <span class="fl">2</span>,</span>
<span>    <span class="fl">1</span>, <span class="st">"James"</span>, <span class="fl">4</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># If the data is of the correct format, all is good</span></span>
<span>  <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="reference/zingle.html">zingle</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, total_fouls<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fouls</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span>, warn.conflicts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># If a name does not match its ID, we should get an error</span></span>
<span>  <span class="va">d</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"name"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Jammes"</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="reference/zingle.html">zingle</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, total_fouls<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fouls</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, error<span class="op">=</span><span class="va">wrap_error</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="getting-a-better-view-on-variables">Getting a better view on variables<a class="anchor" aria-label="anchor" href="#getting-a-better-view-on-variables"></a>
</h2>
<p>The <a href="https://torfason.github.io/zmisc/reference/zingle.html">notate()</a> function adds annotations to <code>factor</code> and <code>labelled</code> variables that make it easier to see both values and labels/levels when using the <a href="https://rdrr.io/r/utils/View.html" class="external-link">View()</a> function</p>
<div class="section level3">
<h3 id="notate-embed-factor-levels-and-value-labels-in-values">notate: Embed factor levels and value labels in values.<a class="anchor" aria-label="anchor" href="#notate-embed-factor-levels-and-value-labels-in-values"></a>
</h3>
<p>This function adds level/label information as an annotation to either factors or <code>labelled</code> variables. This function is called <code><a href="reference/notate.html">notate()</a></code> rather than <code>annotate()</code> to avoid conflict with <code>ggplot2::annotate()</code>. It is a generic that can operate either on individual vectors or on a <code>data.frame</code>.</p>
<p>When printing <code>labelled</code> variables from a <code>tibble</code> in a console, both the numeric value and the text label are shown, but no variable labels. When using the <code><a href="https://rdrr.io/r/utils/View.html" class="external-link">View()</a></code> function, only variable labels are shown but no value labels. For factors, there is no way to view the integer levels and values at the same time.</p>
<p>In order to allow the viewing of both variable and value labels at the same time, this function converts both <code>factor</code> and <code>labelled</code> variables to <code>character</code>, including both numeric levels (<code>labelled</code> values) and character values (<code>labelled</code> labels) in the output.</p>
<div class="section level4">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"4"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    chr <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"bravo"</span>, <span class="st">"chrly"</span>, <span class="st">"delta"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lbl <span class="op">=</span> <span class="fu"><a href="reference/ll_labelled.html">ll_labelled</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>one<span class="op">=</span><span class="fl">1</span>, two<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                      label <span class="op">=</span> <span class="st">"A labelled vector"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/notate.html">notate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span>  <span class="va">dn</span></span>
<span>  <span class="co"># View(dn)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=zmisc" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/torfason/zmisc/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing zmisc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Magnus Thor Torfason <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=zmisc" class="external-link"><img src="https://www.r-pkg.org/badges/version/zmisc" alt="CRAN version"></a></li>
<li><a href="https://github.com/torfason/zmisc" class="external-link"><img src="https://img.shields.io/badge/Git-0.2.3.9004-success" alt="GitHub version"></a></li>
<li><a href="https://github.com/torfason/zmisc/actions" class="external-link"><img src="https://github.com/torfason/zmisc/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/torfason/zmisc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/torfason/zmisc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Magnus Thor Torfason.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
